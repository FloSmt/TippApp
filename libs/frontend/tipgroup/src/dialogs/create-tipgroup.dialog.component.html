<lib-base-dialog-header title="Tippgruppe erstellen" (cancelEvent)="cancel()">
  <ion-buttons slot="buttons">
    <ion-button fill="clear" [disabled]="disableCreateButton()" (click)="createTipgroup()"
                data-testid="create-tipgroup-submit-button">
      <ion-label>
        @if (isLoadingAvailableLeagues()) {
          <ion-spinner name="dots"></ion-spinner>
        } @else {
          Erstellen
        }
      </ion-label>
    </ion-button>
  </ion-buttons>
</lib-base-dialog-header>
<ion-content class="ion-padding">
  <custom-header-content-condense title="Tippgruppe erstellen"></custom-header-content-condense>
  @if (isLoadingAvailableLeagues() || availableLeagues.isLoading()) {
    <div class="loading-container" data-testid="spinner">
      <ion-spinner></ion-spinner>
    </div>
  } @else if (hasAvailableLeaguesError()) {
    <lib-error-card
      title="Fehler"
      message="Beim laden der Wettbewerbe ist ein Fehler aufgetreten. Versuche es später erneut!">
    </lib-error-card>
  } @else {
    <form [formGroup]="createForm">
      <custom-input name="tipgroup-name-input" type="text"
                    formControlName="name"
                    autocomplete="username"
                    label="Name der Tippgruppe"
                    data-testid="tipgroup-name-input" placeholder="Beispiel-Tippspiel" [maxLength]="nameMaxLength"
                    [errorMessage]="getErrorMessage('name')"></custom-input>

      <custom-select label="Wettbewerb"
                     data-testid="tipgroup-league-select" [options]="getSelectOptions()"
                     [control]="this.createForm.controls.selectedLeague">
      </custom-select>

      <custom-input
        formControlName="password"
        label="Password"
        type="password"
        autocomplete="new-password"
        [enablePasswordToggle]="true"
        data-testid="password-input"
        [errorMessage]="getErrorMessage('password')">
      </custom-input>
      <custom-input
        formControlName="passwordConfirm"
        label="Password wiederholen"
        type="password"
        autocomplete="new-password"
        [enablePasswordToggle]="true"
        data-testid="password-confirm-input"
        [errorMessage]="getErrorMessage('passwordConfirm')">
      </custom-input>
    </form>

    <div class="info-cards">
      <ion-item class="info-card">
        <div slot="start" class="icon-container">
          <ion-icon name="text-outline"></ion-icon>
        </div>
        <ion-label>
          <h3>Name der Tippgruppe</h3>
          <p>Mit diesem Namen können andere Spieler deine Tippgruppe finden und ihr beitreten. Der Name sollte aus
            diesem
            Grund einzigartig sein</p>
        </ion-label>
      </ion-item>
      <ion-item class="info-card">
        <div slot="start" class="icon-container">
          <ion-icon name="trophy"></ion-icon>
        </div>

        <ion-label>
          <h3>Wettbewerb</h3>
          <p>Der Wettbewerb bestimmt, welche Spiele automatisch in deine Tippgruppe übernommen werden. Die Spieltage
            können
            später individuell angepasst und mit Spielen aus anderen Wettbewerben erweitert werden.</p>
        </ion-label>
      </ion-item>

      <ion-item class="info-card">
        <div slot="start" class="icon-container">
          <ion-icon name="shield-checkmark"></ion-icon>
        </div>

        <ion-label>
          <h3>Password</h3>
          <p>Mit diesem Password können andere Spieler deiner Tippgruppe beitreten. Du kannst es später in den
            Einstellungen
            ändern.</p>
        </ion-label>
      </ion-item>
    </div>
  }
</ion-content>
